



                                                                      
                                         ‚ñÑ‚ññ‚ñü‚ñà‚ñõ‚ñÑ‚ñÑ     ‚ñÑ‚ñÑ‚ñÑ‚ñÑ‚ñÑ‚ññ           
                                       ‚ñó‚ñú‚ñà‚ñà‚ñú‚ñà‚ñõ‚ñà‚ñà‚ñê‚ñÑ ‚ñó‚ñà‚ñò ‚ñÄ‚ñà‚ñà‚ñà‚ñà‚ññ         
                                      ‚ñó‚ñà‚ñò‚ñú‚ñà‚ñû‚ñú‚ñå‚ñà‚ñà‚ñü‚ñà‚ñå‚ñê‚ñô      ‚ñÄ‚ñÄ‚ññ        
                 ‚ñÑ‚ñÑ‚ñà‚ñà‚ñà‚ñà‚ñà‚ñÑ             ‚ñú‚ñû‚ñÄ‚ñô‚ñà‚ñê‚ñà‚ñó‚ñú‚ñö‚ñà‚ñõ‚ñü‚ññ‚ñú‚ñô‚ññ               
                 ‚ñÄ‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñô               ‚ñù‚ñÑ‚ñõ‚ñô‚ñà‚ñå‚ñà‚ñú‚ñü‚ñà‚ñå  ‚ñÄ‚ñú‚ñà‚ñÑ‚ñÑ‚ñÑ          
                ‚ñó‚ñõ‚ñõ‚ñÑ‚ñê‚ñà‚ñà‚ñà‚ñà‚ñà‚ñÑ             ‚ñó‚ñü‚ñô‚ñà‚ñÄ‚ñô‚ñà‚ñü‚ñà‚ñõ‚ñô‚ñå       ‚ñÄ‚ñú‚ñô‚ñÑ       
               ‚ñó‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå‚ñà‚ñà‚ñà‚ññ          ‚ñó‚ñü‚ñà‚ñú‚ñÑ‚ñà‚ñõ‚ñú‚ñå‚ñà‚ñü‚ñà‚ñà‚ñò         ‚ñù‚ñú‚ñô      
                ‚ñù‚ñà‚ñà‚ñà‚ñü‚ñà‚ñà‚ñô‚ñü‚ñà‚ñà‚ñà‚ññ      ‚ñó‚ñÑ‚ñà‚ñà‚ñú‚ñü‚ñà‚ñà‚ñà‚ñà‚ñõ‚ñü‚ñÄ‚ñú‚ñà‚ñû‚ñü‚ñô‚ñÑ‚ññ       ‚ñê‚ñà‚ñå     
                 ‚ñà‚ñà‚ñà‚ñê‚ñà‚ñà‚ñå‚ñô‚ñú‚ñà‚ñà‚ñà‚ñô  ‚ñó‚ñÑ‚ñà‚ñõ‚ñú‚ñô‚ñõ‚ñú‚ñà‚ñà‚ñà‚ñõ‚ñö‚ñà‚ñà‚ñà‚ñà‚ñú‚ñà‚ñà‚ñà‚ñà‚ñà‚ñô‚ññ‚ñÑ‚ñÑ‚ñÑ‚ñÑ‚ñÑ‚ñà‚ñà‚ñò     
                  ‚ñó‚ñà‚ñü‚ñà‚ñà‚ñå‚ñà‚ñô‚ñú‚ñà‚ñÄ‚ñö‚ñü‚ñà‚ñù‚ñú‚ñÑ‚ñõ‚ñà‚ñü‚ñõ‚ñú‚ñõ‚ñà‚ñÑ‚ñÑ‚ñÑ‚ñÑ‚ñÑ‚ñÑ‚ñü‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñô‚ñú‚ñà‚ñà‚ñõ‚ñÄ       
                  ‚ñê‚ñö‚ñà‚ñà‚ñà‚ñå‚ñú‚ñà‚ñÑ‚ñà‚ñú‚ñà‚ñà‚ñö‚ñõ‚ñà‚ñü‚ñú‚ñô‚ñê‚ñÄ‚ñü‚ñà‚ñÑ‚ñÑ‚ñà‚ñõ‚ñà‚ñü‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñô           
                  ‚ñü‚ñû‚ñú‚ñô‚ñü‚ñà‚ñà‚ñà‚ñà‚ñô‚ñà‚ñà‚ñö‚ñü‚ñú ‚ñõ‚ñÑ‚ñÑ‚ñõ‚ñú‚ñà‚ñÑ‚ñÄ‚ñà‚ñü‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñú‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ññ         
                  ‚ñô‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñú‚ñü‚ñà‚ñõ ‚ñô‚ñó‚ñô‚ñõ‚ñú‚ñô‚ñà‚ñÄ‚ñà‚ñÑ‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñÄ‚ñÄ‚ñà‚ñû‚ñú‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñô‚ñÑ       
                ‚ñó‚ñü‚ñà‚ñà‚ñà‚ñà‚ñà‚ñú‚ñü‚ñà‚ñõ‚ñô‚ñà‚ñô‚ñú‚ñà‚ñü‚ñÄ‚ñô‚ñÑ‚ñà‚ñà‚ñà‚ñÄ‚ñÄ‚ñÄ‚ñÄ‚ñò      ‚ñà‚ñà‚ñà‚ñô‚ñü‚ñú‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñô   
                ‚ñü‚ñà‚ñà‚ñà‚ñà‚ñõ‚ñü‚ñà‚ñà‚ñö‚ñû‚ñà‚ñà‚ñÄ‚ñà‚ñÑ‚ñÄ‚ñÄ‚ñÄ‚ñò              ‚ñù‚ñà‚ñà‚ñà‚ñà‚ñå ‚ñù‚ñÄ‚ñÄ‚ñÄ‚ñÄ‚ñÄ‚ñÄ‚ñú‚ñà‚ñà‚ññ  
             ‚ñó‚ñÑ‚ñü‚ñà‚ñà‚ñà‚ñà‚ñö‚ñà‚ñà‚ñõ‚ñû‚ñò‚ñò‚ñù‚ñà‚ñÑ‚ñà‚ñà‚ñÑ                  ‚ñù‚ñú‚ñà‚ñà‚ñô         ‚ñú‚ñà‚ñà  
          ‚ñó‚ñÑ‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñö‚ñÄ‚ñÄ‚ñò       ‚ñÄ‚ñà‚ñà‚ñô‚ññ                 ‚ñó‚ñà‚ñà‚ñõ         ‚ñù‚ñà‚ñà  
        ‚ñó‚ñü‚ñà‚ñà‚ñà‚ñà‚ñà‚ñÄ‚ñÄ‚ñò              ‚ñú‚ñà‚ñà               ‚ñó‚ñü‚ñà‚ñõ‚ñò           ‚ñà‚ñà  
 # What do you get when you combine a high performance load balancer and your CLI?
 ### that's right, a NGINX SPHINX!
 Give our sphinx your poor, your tired, and your access logs and she will parse and query them for you. You don't even have to solve any riddles.
 
 ## Context
 The project MVP was created as a technical exercise for an interview with Slalom Portland.
 A provided spec included sample data, functionality requirements, and a schema for the parsed nginx data.
 
 ## Technologies
 - Node.js
 - Mocha and Chai
 - Commander
 - grok-js
 - Chalk
 
 ## Intial Setup
 - clone down this repository (if you don't already have it)
 - `cd` into `nginx-sphinx` and run `npm install`
 - then, to link the app to your CLI, run `npm link`
 - you're good to go!

## Using the App

### view all the commands and their descriptions: `nginx-sphinx`
Just type `nginx-sphinx` into the command line to see a list of commands and associated options. Commands are displayed alongside their arguments, so if you're ready to leave this README behind you can use that command to find out everything you need to know about the app.

Additionally, for more detail, you can run `nginx-sphinx -help` or `nginx-sphinx -h`.

<p align = "center">
<img src="https://media.giphy.com/media/z1Xqaxq8mupqmc2cOH/giphy.gif">
</p>

### convert a nginx log to JSON: `nginx-sphinx parse <source> <destination>`
To convert a log file to a JSON file, run `nginx-sphinx parse <source> <destination>` where source is the filepath of the original log and destination is the desired filepath for the JSON.

Note that you will recieve an error message if (a) the source filepath does not exist/cannot be found, (b) the destination filepath already exists, or (c) one of the provided paths is of the wrong type: the source should be a `.log` file (e.g. access.log) and the destination path should be for a `.json` file (e.g. access.json).

If you the conversion was successful, you will recieve the following message:
```
Looks good üëç
Entries from [source] have been successfully converted to JSON and stored in [destination]
```

<p align = "center">
<img src="https://media.giphy.com/media/9MIyNk3fyzWDuFVW78/giphy.gif">
</p>

### query the converted log: `nginx-sphinx query -param <query type> <log> <date>`
To query for the agent with the most hists on a given day, run `nginx-sphinx query -p agent <log> <date>` where `log` is the filepath of a parsed nginx log and the data is formatted `[day]/[month]/[year]`, e.g. `10/Nov/2020`.

To query for the most popular HTTP method and path on a given day, use the same query but using `request` instead of `agent` as the parameter following `-p`.

<p align = "center">
<img src="https://media.giphy.com/media/hMuaUYUiCMLYBQublR/giphy.gif">
</p>


## Notes for Future Iterations

### Improving performance
The current parsing functionality uses a synchronous function from the `grok-js` npm module. This creates a bottleneck when parsing nginx logs into JSON so that longer logs can take several minutes to process. A first rpiority for the next iteration of this project is to debug an asynchronous implementation of parsing to speed this process.

### Refining the UI
Error handling can be made more robust for a variety of CLI input issues, and the handling of user arguments can be made more dynamic (e.g. to handle a variety of date inputs for queries). Additionally, the CLI styling can be further enhanced via the selection of a custom app color scheme. Ideally, some amount of user experience research should be undertaken with users of Nginx to ensure that the current command selection is aligned with user needs.

### Testing
Unit tests can be made more thorough with additional threads of sad path testing. It would also be beneficial to look into testing for performance.

### Additional Features
- parsing nginx error logs (or other varieties of logs)
- additional query options (return total hits for every agent, total frequency for every HTTP method+path combo, date range of log, etc)
- ability to update previously parsed logs with new data
- enhanced `--help`section with a more complete description of each command and errors to look out for

